#!/bin/sh
# https://www.pixelstech.net/article/1352825068-Use-rsync-to-delete-mass-files-quickly-in-Linux
# https://unix.stackexchange.com/a/277205
# https://www.slashroot.in/which-is-the-fastest-method-to-delete-files-in-linux
# https://serverfault.com/questions/183821/rm-on-a-directory-with-millions-of-files/328305#328305
# https://github.com/edannenberg/kubler/blob/b39da52634537dde547d82b911a2f9192887c9b6/lib/bob-core/portage-git-sync.sh#L19
_tmp=$(mktemp -d /tmp/XXX)
[ "$2" = "s" ] && s=sudo
eval "${s}" rsync -a --delete "$_tmp"/ "$1" || exit 1
eval "${s}" rmdir "$1" "$_tmp"
